<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timezone Check</title>
    <script>
        // Function to handle incoming requests
        const handleRequest = (req, res) => {
            // Get the JSON object from the request
            let body = '';

            req.on('data', chunk => {
                body += chunk.toString(); // Convert Buffer to string
            });

            req.on('end', () => {
                const data = JSON.parse(body); // Parse the JSON data

                // Check if timezone is Japan and URL contains 'gclid'
                const isTimezoneJapan = data.timezone === 'Asia/Calcutta';
                const hasGclid = data.fullUrl.includes('gclid');

                if (isTimezoneJapan && hasGclid) {
                    // Create a base64 encoded string to return
                    const responseData = 'Hello from Japan!'; // Example message
                    const encodedData = btoa(responseData); // Encode the string in Base64

                    res.writeHead(200, { 'Content-Type': 'text/plain' });
                    res.end(encodedData); // Send the encoded string back to the client
                } else {
                    res.writeHead(400, { 'Content-Type': 'text/plain' });
                    res.end('Conditions not met'); // Handle the case where conditions are not met
                }
            });
        };

        // Function to create a server
        const createServer = () => {
            const http = require('http');
            const server = http.createServer(handleRequest);
            const port = 3000; // Change port as necessary

            server.listen(port, () => {
                console.log(`Server running at http://localhost:${port}/`);
            });
        };

        // Start the server
        createServer();
    </script>
</head>
<body>
    <h1>Timezone and URL Check</h1>
    <p>Server is running. Check the console for messages.</p>
</body>
</html>
